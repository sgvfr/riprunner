{"version":3,"sources":["webpack:///./src/app/menu-callout-monitor/menu-callout-monitor.component.html","webpack:///./src/app/menu-callout-monitor/menu-callout-monitor.component.ts","webpack:///./src/app/menu-callout-monitor/menu-callout-monitor.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iHACE,wHAAkD,KAO9C,oJAA6B,KAC3B,6IAAsB,KACpB,uHAAI,KACA,uHAAI,KACF,6IAAuB,yFAAY,MACnC,yLAAyD,KACzD,uHAAK,KACH,sHAAI,KACF,uHAAI;;;iZAAiC,GAA9B,wDAA6B,IAAC,iFAAS,MAIpD,wHAAI,KACF,2IAAoB,iFAAI,MACxB,uLAAsD,KACtD,wHAAK,KACH,uHAAI,KACF,uHAAI;;;iZAA6B,GAA1B,wDAAyB,IAAC,8EAAM,2BAThC,2CAA6B,GAAhC,aAAiC,EAA9B,SAA6B,GAS7B,uCAAyB,GAA5B,aAA6B,EAA1B,SAAyB,2BAT5B,uMAAiC,GASjC,uMAA6B;8RAzBrD,qJAA8B,KAC5B,iuBAAkD,GAA7C,uDAA4C,IAiCjD,kNAAqE,KACjE,qHAAG,KACD,gNAAoF,KAAO,0IAE7F,MACA,sHAAG,wHAEH,MAEJ,wJAAiC,sFAAS,MAC1C,2JAAoC,+FAAkB,MACtD,gJAAkB,0FAAa,8HAAK,KAEpC,0HAAO,KACL,uHAAI,KACA,uHAAI,KACF,0JAA6B,KAEjC,uHAAI,KACA,kKAAqC,KACjC,wHAAK,oGAAuB,2BArDnC,kDAA4C,GAAjD,YAAkD,EAA7C,SAA4C;;;;;;;;;;;;;;;;ACDnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoF;AACzC;AACc;AAEjB;AACU;AAElD;IAsBE,qCAAoB,QAAkB,EAClB,KAAqB,EACrB,WAAwB,EACxB,mBAAwC;QAHxC,aAAQ,GAAR,QAAQ,CAAU;QAClB,UAAK,GAAL,KAAK,CAAgB;QACrB,gBAAW,GAAX,WAAW,CAAa;QACxB,wBAAmB,GAAnB,mBAAmB,CAAqB;IAC5D,CAAC;IAED,8CAAQ,GAAR;QAAA,iBA+EC;QA9EC,QAAQ,CAAC;QAET,IAAI,iBAAiB,GAAG,EAAE,CAAC;QAC3B,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK;aAClB,WAAW;aACX,SAAS,CAAC,gBAAM;YACf,KAAI,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAC/B,KAAI,CAAC,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YACjC,KAAI,CAAC,SAAS,GAAG,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;YAE3C,IAAI,KAAI,CAAC,GAAG,KAAK,EAAE,IAAI,KAAI,CAAC,IAAI,KAAK,EAAE,IAAI,KAAI,CAAC,SAAS,KAAK,EAAE,EAAE;gBAChE,iBAAiB,GAAG,UAAQ,KAAI,CAAC,GAAG,cAAS,KAAI,CAAC,IAAI,mBAAc,KAAI,CAAC,SAAW,CAAC;aACtF;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC;QAChC,IAAM,YAAY,GAAG,IAAI,CAAC;QAE1B,IAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAClC,IAAI,GAAG,IAAI,IAAI,EAAE;YACb,QAAQ,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,+EAA+E,CAAC,CAAC;YAC9F,KAAK,CAAC,0GAA0G,CAAC,CAAC;SACrH;aACI;YACH,UAAU,CAAC,cAAa,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;SAC9C;QAED,kDAAkD;QAClD,IAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,gEAA8D,iBAAmB,CAAC,CAAC;QACnH,IAAI,CAAC,MAAM,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,CAAC;QACnC,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAS,KAAK;YACpD,IAAI;gBACF,WAAW;gBAEX,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACpC,IAAI,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE;oBACf,QAAQ,CAAC;oBACT,YAAY,CAAC,eAAe,EAAE,CAAC;oBAC/B,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;oBAEnD,IAAM,MAAM,GAAG,YAAY,CAAC,mBAAmB,CAAC,eAAe,EAAE,CAAC;oBAClE,IAAM,SAAS,GAAG,CAAC,YAAY,CAAC,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,gBAAc,YAAY,CAAC,SAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;oBAC1F,IAAM,WAAW,GAAG,4CAA0C,MAAM,CAAC,WAAW,aAAQ,IAAI,CAAC,EAAE,cAAS,IAAI,CAAC,KAAK,GAAG,SAAW,CAAC;oBACjI,IAAM,WAAW,GAAG,YAAY,CAAC,cAAc,CAAC,WAAW,GAAG,iBAAiB,CAAC,CAAC;oBAEjF,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;oBACrC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAC;iBACtD;gBACD,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,eAAe,GAAG,KAAK,CAAC,WAAW,GAAG,gBAAgB,GAAG,IAAI,CAAC,KAAK,GAAG,QAAQ,GAAG,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;aAC1H;YACD,OAAM,EAAE,EAAE;gBACR,QAAQ,CAAC;gBACT,OAAO,CAAC,IAAI,CAAC,4CAA4C,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC;aACzE;QACH,CAAC,EAAE,KAAK,CAAC,CAAC;QAEV,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAS,KAAK;YACjD,WAAW;YACX,OAAO,CAAC,IAAI,CAAC,4BAA4B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;YACzE,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;YAC5B,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,8BAA8B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;YACtF,YAAY,CAAC,sBAAsB,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QACzD,CAAC,EAAE,KAAK,CAAC,CAAC;QAEV,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAS,KAAK;YAClD,QAAQ,CAAC;YACT,IAAI,KAAK,CAAC,UAAU,IAAI,CAAC,EAAE,EAAE,qBAAqB;gBAChD,OAAO,CAAC,IAAI,CAAC,4BAA4B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;gBACzE,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,kCAAkC,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;gBAC1F,YAAY,CAAC,sBAAsB,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;aAC5D;iBACI;gBACH,OAAO,CAAC,IAAI,CAAC,oBAAoB,GAAG,KAAK,CAAC,UAAU,GAAG,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;aAC9F;QACH,CAAC,EAAE,KAAK,CAAC,CAAC;QAEV,OAAO,CAAC,IAAI,CAAC,8BAA8B,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IACjE,CAAC;IAED,iDAAW,GAAX;QACE,QAAQ,CAAC;QACT,IAAI,IAAI,CAAC,GAAG,KAAK,SAAS,EAAE;YAC1B,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;SACxB;IACH,CAAC;IAED,gDAAU,GAAV,UAAW,UAAkB;QAC3B,QAAQ,CAAC;QAET,IAAI;YACF,OAAO,CAAC,IAAI,CAAC,+BAA+B,GAAG,UAAU,CAAC,CAAC;YAC3D,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,IAAI,IAAI,CAAC,cAAc,KAAK,UAAU,EAAE;gBACrE,IAAM,YAAY,GAAG,IAAI,CAAC;gBAC1B,IAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;gBAC1B,KAAK,CAAC,GAAG,GAAG,mCAAmC,CAAC;gBAChD,KAAK,CAAC,IAAI,EAAE,CAAC;gBACb,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE;oBAC9B,QAAQ,CAAC;oBACT,OAAO,CAAC,IAAI,CAAC,gEAAgE,GAAG,UAAU,CAAC,CAAC;oBAC5F,IAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;oBACpC,IAAI,GAAG,IAAI,IAAI,EAAE;wBACb,QAAQ,CAAC;wBACT,OAAO,CAAC,IAAI,CAAC,+EAA+E,CAAC,CAAC;wBAE9F,KAAK,CAAC,2EAA2E,CAAC,CAAC;qBACtF;oBACD,OAAO,CAAC,IAAI,CAAC,4CAA4C,CAAC,CAAC;gBAC7D,CAAC,EAAE,KAAK,CAAC,CAAC;gBACV,QAAQ,CAAC;gBACT,KAAK,CAAC,IAAI,EAAE,CAAC;gBAEb,OAAO,CAAC,IAAI,CAAC,uDAAuD,CAAC,CAAC;aACvE;iBACI;gBACH,OAAO,CAAC,IAAI,CAAC,yDAAyD,CAAC,CAAC;aACzE;SACF;QACD,OAAM,EAAE,EAAE;YACR,QAAQ,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,qCAAqC,GAAG,UAAU,GAAG,UAAU,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC;YAC3F,KAAK,CAAC,oBAAoB,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,UAAU,CAAC;SACnC;IACH,CAAC;IAED,qDAAe,GAAf;QACE,QAAQ,CAAC;QACT,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;QACpB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,8BAA8B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;QAC9E,OAAO,CAAC,IAAI,CAAC,8BAA8B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;QAC3E,IAAI,CAAC,sBAAsB,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;IACrD,CAAC;IAED,4DAAsB,GAAtB,UAAuB,GAAG,EAAE,SAAS;QACnC,WAAW;QACX,IAAI;YACF,IAAI,SAAS,EAAE;gBACb,OAAO,CAAC,IAAI,CAAC,2BAA2B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;gBACxE,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,EAAE;oBAC3C,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;oBACzD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;iBAChE;qBACI;oBACH,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;oBACpD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;iBAC3D;aACF;iBACI;gBACH,OAAO,CAAC,IAAI,CAAC,8BAA8B,GAAG,IAAI,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;gBAC3E,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,EAAE;oBAC3C,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;oBAC5D,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;iBAC7D;qBACI;oBACH,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;oBACvD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;iBACxD;aACF;YACD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,GAAG,GAAG,GAAG,aAAa,CAAC;SAC/D;QACD,OAAM,EAAE,EAAE;YACR,QAAQ,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,yCAAyC,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC;SACtE;IACH,CAAC;IAEO,iDAAW,GAAnB;QACE,OAAO,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;IACjD,CAAC;IAEO,oDAAc,GAAtB,UAAuB,GAAW,EAAE,UAA0B;QAA1B,8CAA0B;QAC5D,YAAY;QACZ,GAAG,GAAG,IAAI,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC;QAC/B,OAAO,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;IAC1D,CAAC;IACH,kCAAC;AAAD,CAAC;;AAED;IAGE,gBAAY,EAAE;QACZ,YAAY;QACZ,IAAI,CAAC,EAAE,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;IACxC,CAAC;IAED,oBAAG,GAAH,UAAI,GAAG,EAAE,SAAgB;QAAhB,4CAAgB;QACvB,YAAY;QACZ,IAAM,QAAQ,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;QACnD,IAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;QACtC,CAAC,CAAC,SAAS,GAAG,SAAS,IAAI,MAAM,CAAC;QAClC,CAAC,CAAC,WAAW,GAAG,GAAG,CAAC;QACpB,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QACxB,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IAChC,CAAC;IAED,sBAAK,GAAL;QACE,YAAY;QACZ,IAAI,CAAC,EAAE,CAAC,WAAW,GAAG,EAAE,CAAC;IAC3B,CAAC;IACH,aAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1OD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuD;AACqB;AAEG;SAMnE;IACJ,WAAW,EAAE;QACX,IAAI,EAAE,oBAAoB;QAC1B,UAAU,EAAE,QAAQ;KACrB;CACF;AARP,IAAM,UAAU,GAAW;IACzB,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,2FAA2B;QAChD,WAAW,EAAE,CAAC,mEAAmB,CAAC;QAChC,IAAI,IAKH;KACJ;CACF,CAAC;AAEF;IAAA;IAawC,CAAC;IAAD,+BAAC;AAAD,CAAC","file":"menu-callout-monitor-menu-callout-monitor-module-ngfactory.js","sourcesContent":["<div class=\"container_center\">\n  <div *ngxPermissionsOnly=\"['USER-AUTHENTICATED']\">\n      \n  <!-- \n      {% include 'user-welcome.twig.html' %}\n      {% include 'live-callout-warning.twig.html' %}\n      \n  -->\n      <div class=\"menudiv_wrapper\">\n        <nav class=\"vertical\">\n          <ul>\n              <li>\n                <label for=\"main_page\">Return to ..</label>\n                <input type=\"radio\" name=\"verticalMenu\" id=\"main_page\" />\n                <div>\n                  <ul>\n                    <li><a [routerLink]=\"['/main-menu']\">Main Menu</a></li>\n                  </ul>\n                </div>\n              </li>\n              <li>\n                <label for=\"logout\">Exit</label>\n                <input type=\"radio\" name=\"verticalMenu\" id=\"logout\" />\n                <div>\n                  <ul>\n                    <li><a [routerLink]=\"['/login']\">Logout</a></li>\n                  </ul>\n                </div>\n              </li>\n            </ul>\n        </nav>\n      </div>\n  </div>\n  \n  <div #dialogMessage title=\"Error\" style=\"display:none\" role=\"dialog\">\n      <p>\n        <span class=\"ui-icon ui-icon-circle-check\" style=\"float:left; margin:0 7px 50px 0;\"></span>\n        CANNOT Open popups as you have a popup blocker for this website!\n      </p>\n      <p>\n        Please allow this website to open popups.\n      </p>\n  </div>\n  <button onclick=\"logger.clear()\">Clear log</button>\n  <button onclick=\"closeConnection()\">Stop reconnections</button>\n  <span #connection>Connecting...<div></div></span>\n  \n  <table>\n    <tr>\n        <td>\n          <div class=\"border\" id=\"log\"></div>\n      </td>\n      <td>\n          <div class=\"border\" id=\"right-panel\">\n              <div>Waiting for callouts...</div>\n          </div>\n      </td>\n  </tr>\n  </table>\n\n</div>\n","import { Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { AuthService } from '@app/auth';\nimport { SystemConfigService } from '@app/common';\n\n@Component({\n  selector: 'app-menu-callout-monitor',\n  templateUrl: './menu-callout-monitor.component.html',\n  styleUrls: ['./menu-callout-monitor.component.css']\n})\n\nexport class MenuCalloutMonitorComponent implements OnInit {\n\n  @ViewChild('connection',{static:false}) public connection: ElementRef;\n  @ViewChild('dialogMessage',{static:false}) public dialogMessage: ElementRef;\n\n  lastCalloutURL: string;\n  source;\n  logger: Logger;\n\n  private ast: string;\n  private fhid: string;\n  private member_id: string;\n\n  private sub: any;\n  public systemConfig;\n\n  constructor(private location: Location,\n              private route: ActivatedRoute,\n              private authService: AuthService,\n              private systemConfigService: SystemConfigService) {\n  }\n\n  ngOnInit() {\n    debugger;\n\n    let authSpecialParams = '';\n    this.sub = this.route\n      .queryParams\n      .subscribe(params => {\n        this.ast = params['ast'] || '';\n        this.fhid = params['fhid'] || '';\n        this.member_id = params['member_id'] || '';\n\n        if (this.ast !== '' && this.fhid !== '' && this.member_id !== '') {\n          authSpecialParams = `&ast=${this.ast}&fhid=${this.fhid}&member_id=${this.member_id}`;\n        }\n    });\n\n    this.logger = new Logger('log');\n    const thisInstance = this;\n\n    const win = window.open('_blank');\n    if (win == null) {\n        debugger;\n        console.info('In window.open ERROR!!! cannot popup page likely blocked from popup blocker!.');\n        alert('CANNOT Open popups as you have a popup blocker! Please allow popus for this website and reload the page.');\n    }\n    else {\n      setTimeout(function() { win.close(); }, 500);\n    }\n\n    // sends messages with text/event-stream mimetype.\n    const url = this.getExternalUrl(`controllers/callout-monitor-controller.php?server_mode=true${authSpecialParams}`);\n    this.source = new EventSource(url);\n    this.source.addEventListener('message', function(event) {\n      try {\n        //debugger;\n\n        const data = JSON.parse(event.data);\n        if (data.id > 0) {\n          debugger;\n          thisInstance.closeConnection();\n          thisInstance.logger.log('Got a live page!', 'msg');\n\n          const config = thisInstance.systemConfigService.getSystemConfig();\n          const astParams = (thisInstance.ast !== '' ? `&member_id=${thisInstance.member_id}` : '');\n          const details_url = `ngui/index.html?page=call-details&fhid=${config.firehall_id}&cid=${data.id}&ckid=${data.keyid}${astParams}`;\n          const callout_url = thisInstance.getExternalUrl(details_url + authSpecialParams);\n\n          thisInstance.signalPage(callout_url);\n          thisInstance.logger.log('Playing page tone!', 'msg');\n        }\n        thisInstance.logger.log('lastEventID: ' + event.lastEventId + ', server msg: ' + data.keyid + ' id = ' + data.id, 'msg');\n      }\n      catch(ex) {\n        debugger;\n        console.info('ERROR In addEventListener(message) error: ' + ex.message);\n      }\n    }, false);\n\n    this.source.addEventListener('open', function(event) {\n      //debugger;\n      console.info('Connection was opened at: ' + new Date().toLocaleString());\n      thisInstance.logger.clear();\n      thisInstance.logger.log('> Connection was opened at: ' + new Date().toLocaleString());\n      thisInstance.updateConnectionStatus('Connected', true);\n    }, false);\n\n    this.source.addEventListener('error', function(event) {\n      debugger;\n      if (event.eventPhase == 2) { // EventSource.CLOSED\n        console.info('Connection was closed at: ' + new Date().toLocaleString());\n        thisInstance.logger.log('> Connection was closed (2) at: ' + new Date().toLocaleString());\n        thisInstance.updateConnectionStatus('Disconnected', false);\n      }\n      else {\n        console.info('Connection error: ' + event.eventPhase + 'at: ' + new Date().toLocaleString());\n      }\n    }, false);\n\n    console.info('Will try to connect to url: ' + this.source.url);\n  }\n\n  ngOnDestroy() {\n    debugger;\n    if (this.sub !== undefined) {\n      this.sub.unsubscribe();\n    }\n  }\n\n  signalPage(calloutUrl: string) {\n    debugger;\n\n    try {\n      console.info('In signalPage start for url: ' + calloutUrl);\n      if (this.lastCalloutURL == null && this.lastCalloutURL !== calloutUrl) {\n        const thisInstance = this;\n        const audio = new Audio();\n        audio.src = './assets/sounds/pager_tone_pg.mp3';\n        audio.load();\n        audio.addEventListener('ended', function() {\n          debugger;\n          console.info('In signalPage playing tones ENDED shows call details for url: ' + calloutUrl);\n          const win = window.open(calloutUrl);\n          if (win == null) {\n              debugger;\n              console.info('In window.open ERROR!!! cannot popup page likely blocked from popup blocker!.');\n\n              alert('Page detected, however we CANNOT Open popups as you have a popup blocker!');\n          }\n          console.info('In signalPage playing tones ENDED complete');\n        }, false);\n        debugger;\n        audio.play();\n\n        console.info('In signalPage playing tones: sounds/pager_tone_pg.mp3');\n      }\n      else {\n        console.info('In signalPage callout already signalled, doing nothing.');\n      }\n    }\n    catch(ex) {\n      debugger;\n      console.info('ERROR In signalPage start for url: ' + calloutUrl + ' error: ' + ex.message);\n      alert('Pager tone error: ' + ex.message);\n      window.location.href = calloutUrl;\n    }\n  }\n\n  closeConnection() {\n    debugger;\n    this.source.close();\n    this.logger.log('> Connection was closed at: ' + new Date().toLocaleString());\n    console.info('> Connection was closed at: ' + new Date().toLocaleString());\n    this.updateConnectionStatus('Disconnected', false);\n  }\n\n  updateConnectionStatus(msg, connected) {\n    //debugger;\n    try {\n      if (connected) {\n        console.info('Connection connected at: ' + new Date().toLocaleString());\n        if (this.connection.nativeElement.classList) {\n          this.connection.nativeElement.classList.add('connected');\n          this.connection.nativeElement.classList.remove('disconnected');\n        }\n        else {\n          this.connection.nativeElement.addClass('connected');\n          this.connection.nativeElement.removeClass('disconnected');\n        }\n      }\n      else {\n        console.info('Connection disconnected at: ' + new Date().toLocaleString());\n        if (this.connection.nativeElement.classList) {\n          this.connection.nativeElement.classList.remove('connected');\n          this.connection.nativeElement.classList.add('disconnected');\n        }\n        else {\n          this.connection.nativeElement.removeClass('connected');\n          this.connection.nativeElement.addClass('disconnected');\n        }\n      }\n      this.connection.nativeElement.innerHTML = msg + '<div></div>';\n    }\n    catch(ex) {\n      debugger;\n      console.info('ERROR In updateConnectionStatus error: ' + ex.message);\n    }\n  }\n\n  private getRootPath(): string {\n    return this.location.prepareExternalUrl('../');\n  }\n\n  private getExternalUrl(url: string, handOffJWT: boolean = true): string {\n    // debugger;\n    url = this.getRootPath() + url;\n    return this.authService.injectJWTtoken(url, handOffJWT);\n  }\n}\n\nclass Logger {\n  el: HTMLElement;\n\n  constructor(id) {\n    // debugger;\n    this.el = document.getElementById(id);\n  }\n\n  log(msg, opt_class = null) {\n    // debugger;\n    const fragment = document.createDocumentFragment();\n    const p = document.createElement('p');\n    p.className = opt_class || 'info';\n    p.textContent = msg;\n    fragment.appendChild(p);\n    this.el.appendChild(fragment);\n  }\n\n  clear() {\n    // debugger;\n    this.el.textContent = '';\n  }\n}\n\ninterface Callback { (data: any): void; }\n\ndeclare class EventSource {\n    onmessage: Callback;\n    addEventListener(event: string, cb: Callback): void;\n    constructor(name: string);\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Routes } from '@angular/router';\nimport { NgxPermissionsModule, NgxPermissionsGuard } from 'ngx-permissions';\n\nimport { MenuCalloutMonitorComponent } from './menu-callout-monitor.component';\nimport { SystemSharedModule } from '@app/common';\n\nconst menuRoutes: Routes = [\n  { path: '', component: MenuCalloutMonitorComponent,\n    canActivate: [NgxPermissionsGuard],\n      data: {\n        permissions: {\n          only: 'USER-AUTHENTICATED',\n          redirectTo: '/login'\n        }\n      }\n  },\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    NgxPermissionsModule.forChild(),\n    RouterModule.forChild(menuRoutes),\n    SystemSharedModule,\n  ],\n  providers: [\n  ],\n  declarations: [\n    MenuCalloutMonitorComponent\n  ]\n})\nexport class MenuCalloutMonitorModule { }\n"],"sourceRoot":""}